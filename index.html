
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è˜‡å®¶ 2026 æ±äº¬è¡Œ - å‹•æ…‹è¡Œç¨‹è¡¨</title>
    
    <style>
        :root {
            --primary-color: #336699;
            --secondary-color: #6c757d;
            --background-color: #f4f7f6;
            --card-bg-color: #ffffff;
            --highlight-color: #ffc107; /* é»ƒè‰²ç”¨æ–¼é»æ“Šæç¤º */
        }

        body {
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
            background-color: var(--background-color);
            margin: 0;
            padding: 20px;
            color: #343a40;
        }

        .container {
            max-width: 900px;
            margin: auto;
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .day-container {
            background-color: var(--card-bg-color);
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .day-header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 20px;
            font-size: 1.4rem;
            font-weight: bold;
        }

        /* å¯é»æ“Šçš„æ´»å‹•å¡ç‰‡æ¨£å¼ */
        .activity-card-header {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #e9ecef;
            cursor: pointer; /* é¡¯ç¤ºç‚ºå¯é»æ“Š */
            transition: background-color 0.3s;
        }

        .activity-card-header:hover {
            background-color: #e2f0ff; /* æ»‘é¼ ç§»ä¸Šæ™‚è®Šè‰² */
        }
        
        /* å±•é–‹æŒ‡ç¤ºåœ–æ¨™ */
        .toggle-icon {
            font-size: 1.2rem;
            transition: transform 0.3s;
            margin-left: auto; /* é å³å°é½Š */
        }

        .activity-card-header.active .toggle-icon {
            transform: rotate(90deg); /* å±•é–‹æ™‚æ—‹è½‰åœ–æ¨™ */
        }

        /* éš±è—çš„ç´°ç¯€é¢æ¿ (Accordion) */
        .activity-detail-panel {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out, padding 0.3s;
            background-color: #fcfcfc;
            border-left: 5px solid var(--highlight-color);
        }

        .activity-card-header.active + .activity-detail-panel {
            max-height: 500px; /* è¨­ç½®ä¸€å€‹è¶³å¤ å¤§çš„å€¼ */
            padding: 20px;
        }

        /* åœ–ç‰‡èƒŒæ™¯å€ */
        .detail-photo {
            height: 200px;
            background-size: cover;
            background-position: center;
            border-radius: 4px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 3px black;
        }

        /* èŠ±è²»è¼¸å…¥æ¬„ä½ */
        .cost-input-group {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .cost-input-group input {
            padding: 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            margin-left: 10px;
            width: 120px;
            text-align: right;
        }
        
        /* å…¶ä»–æ¨£å¼ (ä¿æŒä¸è®Š) */
        .time-slot {
            font-weight: bold;
            flex-basis: 120px;
            flex-shrink: 0;
            color: var(--primary-color);
            padding-right: 15px;
            text-align: right;
            border-right: 1px dashed #ced4da;
        }

        .activity-summary {
            flex-grow: 1;
            padding-left: 20px;
        }

        .notes-text {
            color: #6c757d;
            font-size: 0.9em;
            font-style: italic;
        }

        @media (max-width: 600px) {
            .activity-card-header {
                flex-wrap: wrap;
            }
            .time-slot {
                border-right: none;
                border-bottom: 1px dashed #ced4da;
                text-align: left;
                padding-right: 0;
                padding-bottom: 5px;
                flex-basis: 100%;
            }
            .activity-summary {
                padding-left: 0;
                padding-top: 5px;
            }
            .toggle-icon {
                margin-left: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—“ï¸ è˜‡å®¶ 2026 æ±äº¬è¡Œ å‹•æ…‹è¡Œç¨‹è¡¨ </h1>
        
        <div id="itinerary-output"></div>
    </div>

    <script>
        // æ³¨æ„ï¼šé€™è£¡å°‡å…©å€‹ CSV æª”æ¡ˆçš„è³‡æ–™åˆä½µï¼ŒActivity ä½œç‚º Key [cite: 1, 2]ã€‚
        const tripData = [
            {
                "Day": "Day 1",
                "Date": "2026/01/21",
                "Activities": [
                    {
                        "Start time": "05:30",
                        "End time": "06:00",
                        "Activity": "Pickup from Home to TSA",
                        "Owner": "amandasj.yang",
                        "Notes": "Confirmed",
                        "Details": { "Pictures url": "", "QR-Cord": "ç„¡", "Cost": 0 }
                    },
                    {
                        "Start time": "07:15",
                        "End time": "11:10",
                        "Activity": "TSA to HND",
                        "Owner": "amandasj.yang",
                        "Notes": "Confirmed (Taipei Songshan Airport (TSA))",
                        "Details": { "Pictures url": "", "QR-Cord": "ç™»æ©Ÿè­‰ QR code é€£çµ", "Cost": 0 }
                    },
                    {
                        "Start time": "12:00",
                        "End time": "TBD",
                        "Activity": "Option#1: Monorail",
                        "Owner": "è˜‡ä¾¯ç¿”",
                        "Notes": "Draft (Haneda Airport (HND))",
                        "Details": {
                            "Pictures url": "https://bobbyfun.tw/wp-content/uploads/pixnet/8b8e9dfd832a4af2de8cbabbc4574e8e.jpg",
                            "QR-Cord": "Monorail Ticket Link or Text",
                            "Cost": 600 // æ—¥å¹£
                        }
                    },
                    {
                        "Start time": "12:00",
                        "End time": "TBD",
                        "Activity": "Option#2: Keikyu Line",
                        "Owner": "è˜‡ä¾¯ç¿”",
                        "Notes": "Draft",
                        "Details": {
                            "Pictures url": "https://bobbyfun.tw/wp-content/uploads/pixnet/181906e813461a5131aa82dece8c8051.jpg",
                            "QR-Cord": "Keikyu Line Ticket Link or Text",
                            "Cost": 500 
                        }
                    },
                    {
                        "Start time": "14:30",
                        "End time": "TBD",
                        "Activity": "JRä¸Šé‡",
                        "Owner": "amandasj.yang",
                        "Notes": "Planning",
                        "Details": { "Pictures url": "", "QR-Cord": "ç„¡", "Cost": 0 }
                    },
                    {
                        "Start time": "16:00",
                        "End time": "TBD",
                        "Activity": "JRè¶Šå¾Œæ¹¯æ¾¤",
                        "Owner": "",
                        "Notes": "",
                        "Details": { "Pictures url": "", "QR-Cord": "ç„¡", "Cost": 0 }
                    },
                    {
                        "Start time": "08:00",
                        "End time": "TBD",
                        "Activity": "Check-in Hotel",
                        "Owner": "amandasj.yang",
                        "Notes": "è¶Šå¾Œæ¹¯æ¾¤é§…",
                        "Details": { "Pictures url": "", "QR-Cord": "é£¯åº—è¨‚å–® QR code", "Cost": 0 }
                    }
                ]
            },
            {
                "Day": "Day 2",
                "Date": "2026/01/22",
                "Activities": [
                    {
                        "Start time": "09:00",
                        "End time": "TBD",
                        "Activity": "Scean 1",
                        "Owner": "",
                        "Notes": "",
                        "Details": { "Pictures url": "", "QR-Cord": "ç„¡", "Cost": 0 }
                    },
                    {
                        "Start time": "11:00",
                        "End time": "TBD",
                        "Activity": "Lunch",
                        "Owner": "",
                        "Notes": "Planning",
                        "Details": { "Pictures url": "", "QR-Cord": "ç„¡", "Cost": 3000 }
                    }
                ]
            }
        ];

        // ----------------------------------------------------
        
        /** è™•ç†æ™‚é–“æ ¼å¼ */
        const formatTime = (time) => time ? time.substring(0, 5) : 'TBD';
        
        /** è™•ç†èŠ±è²»è¼¸å…¥ - åƒ…åœ¨å‰ç«¯è¨˜éŒ„ */
        function recordCost(activityId, inputElement) {
            const cost = parseFloat(inputElement.value);
            console.log(`æ´»å‹• ID: ${activityId}ï¼Œå·²è¨˜éŒ„èŠ±è²»: ${cost} JPY`);
            
            // *** [TODO: å¾Œç«¯é€£å‹• - å¯¦ä½œ Google Apps Script] ***
            // é€™é‚Šæ˜¯é ç•™çµ¦æœªä¾†ç™¼é€è³‡æ–™åˆ° Google Sheet çš„å‡½å¼ï¼š
            // sendToGoogleSheet(activityId, cost);
            
            // ç”±æ–¼ç›®å‰ç„¡å¾Œç«¯ï¼Œæ­¤è™•åƒ…åœ¨ Console é¡¯ç¤ºè¨˜éŒ„ï¼Œä¸¦å°‡è¼¸å…¥æ¬„ä½æš«æ™‚è®Šç¶ 
            inputElement.style.backgroundColor = '#d4edda'; 
            setTimeout(() => {
                inputElement.style.backgroundColor = 'white';
            }, 1000);
        }
        
        /** æ¸²æŸ“è¡Œç¨‹å¡ç‰‡ */
        function renderActivity(activity, index) {
            const activityId = `activity-${index}`;
            const startTime = formatTime(activity['Start time']);
            const endTime = formatTime(activity['End time']);
            const timeSlot = startTime + (endTime && endTime !== 'TBD' && endTime !== startTime ? ' - ' + endTime : '');
            
            // è©³ç´°è³‡è¨Šå…§å®¹
            const details = activity.Details;
            
            let photoStyle = '';
            let photoContent = 'é»æ“Šå±•é–‹æŸ¥çœ‹è©³ç´°è³‡è¨Š';

            if (details && details['Pictures url']) {
                photoStyle = `background-image: url('${details['Pictures url']}');`;
                photoContent = '';
            } else {
                photoContent = 'ç›®å‰ç„¡ç…§ç‰‡ï¼Œè«‹æŸ¥çœ‹ä¸‹æ–¹è³‡è¨Š';
            }

            return `
                <div class="activity-card-header" onclick="toggleDetailPanel('${activityId}', this)">
                    <div class="time-slot">${timeSlot}</div>
                    <div class="activity-summary">
                        <p><strong>${activity.Activity}</strong></p>
                        <p class="notes-text">è² è²¬äºº: ${activity.Owner.split('@')[0] || 'æœªå®š'} | ç‹€æ…‹: ${activity.Notes || 'ç„¡'}</p>
                    </div>
                    <span class="toggle-icon">â–¶</span>
                </div>
                
                <div class="activity-detail-panel" id="${activityId}">
                    <div class="detail-photo" style="${photoStyle}">${photoContent}</div>

                    <p>ğŸ« <strong>ç¥¨å‹™è³‡è¨Š/é€£çµ:</strong> ${details['QR-Cord'] || 'ç„¡è³‡æ–™'}</p>
                    
                    <div class="cost-input-group">
                        <span>ğŸ’° <strong>å³æ™‚èŠ±è²» (JPY):</strong></span>
                        <input 
                            type="number" 
                            id="cost-${activityId}"
                            value="${details['Cost'] || 0}"
                            placeholder="è¼¸å…¥é‡‘é¡"
                            onchange="recordCost('${activityId}', this)"
                        >
                    </div>
                    
                    <p style="margin-top: 15px; border-top: 1px dashed #eee; padding-top: 10px;">
                        <span class="notes-text">é€™æ˜¯è©³ç´°è³‡è¨Šé é¢ï¼Œå¯æ”¾å…¥åœ°åœ–ã€å°èˆªæŒ‰éˆ•ç­‰ã€‚</span>
                    </p>
                </div>
            `;
        }

        /** å±•é–‹/æ”¶èµ·é¢æ¿çš„å‡½å¼ */
        window.toggleDetailPanel = function(panelId, headerElement) {
            const panel = document.getElementById(panelId);
            
            // æª¢æŸ¥ panel æ˜¯å¦å·²å±•é–‹
            const isExpanded = headerElement.classList.contains('active');
            
            if (isExpanded) {
                // æ”¶èµ·
                panel.style.maxHeight = '0';
                headerElement.classList.remove('active');
            } else {
                // å±•é–‹: ç¢ºä¿åªæœ‰ä¸€å€‹é¢æ¿å±•é–‹ (å¯é¸)
                document.querySelectorAll('.activity-card-header.active').forEach(h => {
                    h.classList.remove('active');
                    h.nextElementSibling.style.maxHeight = '0';
                });
                
                // å±•é–‹ç•¶å‰é¢æ¿
                panel.style.maxHeight = panel.scrollHeight + 'px'; // æ ¹æ“šå¯¦éš›å…§å®¹é«˜åº¦å±•é–‹
                headerElement.classList.add('active');
            }
        }
        
        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œæ¸²æŸ“
        document.addEventListener('DOMContentLoaded', () => {
            const outputDiv = document.getElementById('itinerary-output');
            let activityIndex = 0;
            
            tripData.forEach(day => {
                const dayContainer = document.createElement('div');
                dayContainer.className = 'day-container';
                dayContainer.innerHTML = `<div class="day-header">${day.Day}ï¼š${day.Date}</div>`;

                day.Activities.forEach(activity => {
                    const activityWrapper = document.createElement('div');
                    activityWrapper.className = 'activity-wrapper';
                    activityWrapper.innerHTML = renderActivity(activity, activityIndex++);
                    dayContainer.appendChild(activityWrapper);
                });

                outputDiv.appendChild(dayContainer);
            });
        });
    </script>
</body>
</html>
